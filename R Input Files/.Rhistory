data$DAP = as.numeric(data$DAP)
data = subset(data, Year == "2020")
data$DAP_cat = data$DAP
data$DAP_cat = as.numeric(data$DAP_cat)
for (i in 1:length(data$DAP_cat)){
if (data$DAP[i] >= 100) {
data$DAP_cat[i] = "100"
} else if (data$DAP[i] >= 80) {
data$DAP_cat[i] = "91"
} else if (data$DAP[i] >= 50) {
data$DAP_cat[i] = "55"
}
data$DAP_cat = factor(data$DAP_cat,levels = c("55","91","100"))
data_pl = read.csv("LodgingCategories.csv", header = TRUE, na.strings = "NA")
data = merge(data, data_pl, by = "Genotype")
unique(data$DAP)
head(data)
df = subset(data, DAP_cat == "55")
Fig5A=ggplot(data=df,aes(x=DAP_cat, y=line_raw_slope_N.m, fill=PL_cat))+
geom_boxplot()+
xlab("Condition") +
xlab("Time of Testing (DAP)") +
ylab("Root System Stiffness (N/m)")+
labs(fill = "Lodging Categories")+
scale_fill_manual(name = "Lodging Categories", labels = c("Low Lodging", "Moderate Lodging", "Severe Lodging"), values=c("mistyrose3","slategrey"))+
scale_y_continuous(limits=c(0,12000), breaks=seq(0,12000,2000))+
scale_x_discrete(labels=c('Condition 1'))+
theme_bw()+
theme(legend.position = "none",
axis.title.x =  element_blank(),
axis.title.y =  element_blank(),
axis.text.x = element_text(size=10),
axis.text.y = element_blank(),
axis.ticks.y = element_blank(),
axis.text = element_text(size=10),
axis.title = element_text(size=12))
Fig5A
##Stats###
attach(df)
lm_x <- lm(line_raw_slope_N.m ~ PL_cat)
anova(lm_x)
lm_x_aov=aov(lm_x)
HSD.test(lm_x_aov, trt = c("PL_cat"), console = TRUE)
par(mfrow=c(2,2))
plot(lm_x)
par(mfrow=c(2,1))
plot(df$line_raw_slope_N.m)
hist(df$line_raw_slope_N.m)
resid = residuals(object = lm_x_aov)
shapiro.test(x=resid)
leveneTest(line_raw_slope_N.m ~ PL_cat)
#transformation data to meet assumptions
par(mfrow=c(2,2))
df$tukey <- transformTukey(
df$line_raw_slope_N.m,
start = -10,
end = 10,
int = 0.025,
plotit = TRUE,
verbose = FALSE,
quiet = FALSE,
statistic = 1,
returnLambda = FALSE
)
hist(df$tukey)
lm_x2 <- lm(df$tukey ~ PL_cat)
anova(lm_x2)
lm_x2_aov2=aov(lm_x2)
HSD.test(lm_x2_aov2, trt = c("PL_cat"), console = TRUE)
df$tukey = NULL
detach(df)
df = subset(data, DAP_cat == "91")
Fig5B=ggplot(data=df,aes(x=DAP_cat, y=line_raw_slope_N.m, fill=PL_cat))+
geom_boxplot()+
xlab("Condition") +
ylab("Root System Stiffness (N/m)")+
labs(fill = "Lodging Categories")+
scale_fill_manual(name = "Lodging Categories", labels = c("Low Lodging", "Moderate Lodging", "Severe Lodging"), values=c("mistyrose3","slategrey"))+
scale_y_continuous(limits=c(0,12000), breaks=seq(0,12000,2000))+
scale_x_discrete(labels=c('Condition 2'))+
theme_bw()+
theme(legend.position = "none",
axis.title.x =  element_blank(),
axis.title.y =  element_blank(),
axis.text.x = element_text(size=10),
axis.text.y = element_blank(),
axis.ticks.y = element_blank(),
axis.text = element_text(size=10),
axis.title = element_text(size=12))
Fig5B
##Stats###
attach(df)
lm_x <- lm(line_raw_slope_N.m ~ PL_cat)
anova(lm_x)
lm_x_aov=aov(lm_x)
HSD.test(lm_x_aov, trt = c("PL_cat"), console = TRUE)
par(mfrow=c(2,2))
plot(lm_x)
par(mfrow=c(2,1))
plot(df$line_raw_slope_N.m)
hist(df$line_raw_slope_N.m)
resid = residuals(object = lm_x_aov)
shapiro.test(x=resid)
leveneTest(line_raw_slope_N.m ~ PL_cat)
detach(df)
##2021####
data0 = read.csv("Hostetler_Reneau_et_al_2024.csv", header = TRUE, na.strings = "NA")
data = subset(data0, Experiment == "Lodging Hybrids")
data = subset(data, Test_Type == "A")
data$DAP = as.numeric(data$DAP)
data = subset(data, Year == "2021")
data$Year = as.character(data$Year)
data$DAP = factor(data$DAP,levels = c("83","117"))
#Lodging Data
data_pl = read.csv("LodgingCategories.csv", header = TRUE, na.strings = "NA")
data = merge(data, data_pl, by = "Genotype")
data$PL_cat = as.factor(data$PL_cat)
data$PL_cat = factor(data$PL_cat,levels = c("low","mid","high"))
unique(data$DAP)
df = subset(data, DAP == "83")
Fig5C=ggplot(data=df,aes(x=DAP, y=line_raw_slope_N.m, fill=PL_cat))+
geom_boxplot()+
ylab("Root System Stiffness (N/m)")+
labs(fill = "Lodging Categories")+
scale_fill_manual(name = "Lodging Categories", labels = c("Low Lodging", "Moderate Lodging", "Severe Lodging"), values=c("mistyrose3","slategrey", "pink4"))+
scale_y_continuous(limits=c(0,12000), breaks=seq(0,12000,2000))+
scale_x_discrete(labels=c('Condition 3'))+
theme_bw()+
theme(legend.position = "none",
axis.title.x =  element_blank(),
axis.title.y =  element_blank(),
axis.text.x = element_text(size=10),
axis.text.y = element_blank(),
axis.ticks.y = element_blank(),
axis.text = element_text(size=10),
axis.title = element_text(size=12))
Fig5C
attach(df)
lm_x <- lm(line_raw_slope_N.m ~ PL_cat)
anova(lm_x)
lm_x_aov=aov(lm_x)
HSD.test(lm_x_aov, trt = c("PL_cat"), console = TRUE)
par(mfrow=c(2,2))
plot(lm_x)
par(mfrow=c(2,1))
plot(df$line_raw_slope_N.m)
hist(df$line_raw_slope_N.m)
resid = residuals(object = lm_x_aov)
shapiro.test(x=resid)
leveneTest(line_raw_slope_N.m ~ PL_cat*DAP)
detach(df)
unique(data$DAP)
df = subset(data, DAP == "117")
Fig5D=ggplot(data=df,aes(x=DAP, y=line_raw_slope_N.m, fill=PL_cat))+
geom_boxplot()+
ylab("Root System Stiffness (N/m)")+
labs(fill = "Lodging Categories")+
scale_fill_manual(name = "Lodging Categories", labels = c("Low Lodging", "Moderate Lodging", "Severe Lodging"), values=c("mistyrose3","slategrey", "pink4"))+
scale_y_continuous(limits=c(0,12000), breaks=seq(0,12000,2000))+
scale_x_discrete(labels=c('Condition 4'))+
theme_bw()+
theme(legend.position = "none",
axis.title.x =  element_blank(),
axis.title.y =  element_blank(),
axis.text.x = element_text(size=10),
axis.text.y = element_blank(),
axis.ticks.y = element_blank(),
axis.text = element_text(size=10),
axis.title = element_text(size=12))
Fig5D
attach(df)
lm_x <- lm(line_raw_slope_N.m ~ PL_cat)
anova(lm_x)
lm_x_aov=aov(lm_x)
HSD.test(lm_x_aov, trt = c("PL_cat"), console = TRUE)
par(mfrow=c(2,2))
plot(lm_x)
par(mfrow=c(2,1))
plot(df$line_raw_slope_N.m)
hist(df$line_raw_slope_N.m)
resid = residuals(object = lm_x_aov)
shapiro.test(x=resid)
leveneTest(line_raw_slope_N.m ~ PL_cat*DAP)
detach(df)
##2022####
data0 = read.csv("Hostetler_Reneau_et_al_2024.csv", header = TRUE, na.strings = "NA")
data = subset(data0, Experiment == "Lodging Hybrids")
data = subset(data, Test_Type == "A")
data$DAP = as.numeric(data$DAP)
data = subset(data, Year == "2022")
#Lodging Data
data_pl = read.csv("LodgingCategories.csv", header = TRUE, na.strings = "NA")
data = merge(data, data_pl, by = "Genotype")
data$PL_cat = as.factor(data$PL_cat)
data$PL_cat = factor(data$PL_cat,levels = c("low","mid","high"))
Fig5E=ggplot(data=data,aes(x=PL_cat, y=line_raw_slope_N.m, fill=PL_cat))+
geom_boxplot()+
ylab("Root System Stiffness (N/m)")+
scale_fill_manual(values=c("mistyrose3","slategrey","pink4"),
labels=c("Low", "Moderate", "Severe"),
name = "Lodging Response in 2020")+
scale_y_continuous(limits=c(0,12000), breaks=seq(0,12000,2000))+
scale_x_discrete(labels=c("", "Condition 5", ""))+
theme_bw()+
theme(legend.position = "none",
axis.title.x =  element_blank(),
axis.title.y =  element_blank(),
axis.text.x = element_text(size=10),
axis.text.y = element_blank(),
axis.ticks.y = element_blank(),
axis.text = element_text(size=10),
axis.title = element_text(size=12))
Fig5E
##Stats###
attach(data)
lm_x <- lm(line_raw_slope_N.m ~ PL_cat)
anova(lm_x)
lm_x_aov=aov(lm_x)
HSD.test(lm_x_aov, trt = c("PL_cat"), console = TRUE)
par(mfrow=c(2,2))
plot(lm_x)
par(mfrow=c(2,1))
plot(data$line_raw_slope_N.m)
hist(data$line_raw_slope_N.m)
resid = residuals(object = lm_x_aov)
shapiro.test(x=resid)
leveneTest(line_raw_slope_N.m ~ PL_cat)
detach(data)
ggdraw() +
draw_plot(Fig5A, x = 0, y = 0, width = 0.20, height = 1) +
draw_plot(Fig5B, x = 0.20, y = 0, width = 0.20, height = 1) +
draw_plot(Fig5C, x = 0.40, y = 0, width = 0.20, height = 1) +
draw_plot(Fig5D, x = 0.60, y = 0, width = 0.20, height = 1) +
draw_plot(Fig5E, x = 0.80, y = 0, width = 0.20, height = 1) +
draw_plot_label(label = c("A", "B", "C","D","E"),
size = 15,
x = c(0, 0.195, 0.395, 0.595, 0.795),
y = c(1,1,1,1,1))
#As planting density increases, the root system stiffness decreases.####
cat("\014")
rm(list=ls())
ls()
setwd(dir = "/Users/ashley/Desktop/Hostetler_Reneau_et_al_2023/R Input Files/")
geno = read.csv("Sparks Field 2022 - 2022_MAIZE_Seed_Origin.csv", header = TRUE, na.strings = "NA") #2022 Genotype Data
data0 = read.csv("/Users/ashley/Desktop/Hostetler_Reneau_et_al_2023/R Input Files/Hostetler_Reneau_et_al_2024.csv", header = TRUE, na.strings = "NA") #SMURF Database
names(geno)[1] = "Plot"
names(geno)[3] = "DensityInfo"
names(geno)[4] = "Density"
names(geno)[5] = "Rep"
data = subset(data0, Experiment == "Density Study")
data = merge(data, geno, by = "Plot")
data1 = read.csv("2022_DensityData.csv", header = TRUE, na.strings = "NA") #2022 Genotype Data
data1$ID = paste(data1$Plot, data1$PlantNumber, sep="_")
data$ID = paste(data$Plot, data$Replicate, sep="_")
data1 = data1[,c(14,4,5,6,7,8,9)]
data2 = merge(data, data1, by = "ID")
data2$Density = factor(data2$Density,levels = c("6","12","18","24"))
data2 = subset(data2, Plant.Ht > 120)
data2$StalkDiamAvg = (data2$Stalk.Diam.Major + data2$Stalk.DiamMinimum)/2
#Stats - Does Genotype or Density impact RTS
attach(data2)
lm_x <- lm(line_raw_slope_N.m ~ Genotype.x*Density)
anova(lm_x)
lm_x_aov=aov(lm_x)
HSD.test(lm_x_aov, trt = c("Density"), console = TRUE)
HSD.test(lm_x_aov, trt = c("Density","Genotype"), console = TRUE)
par(mfrow=c(2,2))
plot(lm_x)
par(mfrow=c(2,1))
plot(data$line_raw_slope_N.m)
hist(data$line_raw_slope_N.m)
resid = residuals(object = lm_x_aov)
shapiro.test(x=resid)
leveneTest(line_raw_slope_N.m ~ Genotype.x*Density)
detach(data2)
#Stats - Does Genotype or Density impact Plant Height
attach(data2)
lm_x <- lm(Plant.Ht ~ Genotype.x*Density)
anova(lm_x)
lm_x_aov=aov(lm_x)
HSD.test(lm_x_aov, trt = c("Density","Genotype"), console = TRUE)
HSD.test(lm_x_aov, trt = c("Density"), console = TRUE)
par(mfrow=c(2,2))
plot(lm_x)
par(mfrow=c(2,1))
plot(data2$Plant.Ht)
hist(data2$Plant.Ht)
resid = residuals(object = lm_x_aov)
shapiro.test(x=resid)
leveneTest(Plant.Ht ~ Genotype.x*Density)
detach(data2)
#Stats - Does Genotype or Density impact stalk diameter
attach(data2)
lm_x <- lm(StalkDiamAvg ~ Genotype.x*Density)
anova(lm_x)
lm_x_aov=aov(lm_x)
HSD.test(lm_x_aov, trt = c("Density","Genotype.x"), console = TRUE)
HSD.test(lm_x_aov, trt = c("Density"), console = TRUE)
par(mfrow=c(2,2))
plot(lm_x)
par(mfrow=c(2,1))
plot(data2$StalkDiamAvg)
hist(data2$StalkDiamAvg)
resid = residuals(object = lm_x_aov)
shapiro.test(x=resid)
leveneTest(StalkDiamAvg ~ Genotype.x*Density)
detach(data2)
Fig6A=ggplot(data=data2,aes(x=Density, y=Plant.Ht, fill=Genotype.x))+
geom_boxplot(size = 0.25) +
xlab("Density (plants/row)") +
ylab("Stalk Height (cm)")+
labs(fill = "Density (plants/plot)")+
scale_y_continuous(limits=c(0,300), breaks=seq(0,300,50))+
scale_fill_manual(values=c("pink4","slategray"))+
theme_bw()+
theme(legend.position = "none",
axis.text.x = element_blank(),
axis.text.y = element_blank(),
axis.title.x =  element_blank(),
axis.title.y =  element_blank(),
axis.ticks.x=element_blank(),
axis.ticks.y=element_blank(),
axis.text = element_text(size=10),
axis.title = element_text(size=12))
Fig6A
Fig6B=ggplot(data=data2,aes(x=Density, y=StalkDiamAvg, fill=Genotype.x))+
geom_boxplot(size = 0.25) +
xlab("Density (plants/row)") +
ylab("Average Stalk Diameter (mm)")+
labs(fill = "Density (plants/plot)")+
scale_y_continuous(limits=c(0,35), breaks=seq(0,35,5))+
scale_fill_manual(values=c("pink4","slategray"))+
theme_bw()+
theme(legend.position = "none",
axis.text.x = element_blank(),
axis.text.y = element_blank(),
axis.title.x =  element_blank(),
axis.title.y =  element_blank(),
axis.ticks.x=element_blank(),
axis.ticks.y=element_blank(),
axis.text = element_text(size=10),
axis.title = element_text(size=12))
Fig6B
Fig6C=ggplot(data=data2,aes(x=Density, y=line_raw_slope_N.m, fill=Genotype.x))+
geom_boxplot(size = 0.25) +
xlab("Density (plants/plot)") +
ylab("Root System Stiffness (N/m)")+
labs(fill = "Hybrid")+
scale_fill_manual(values=c("pink4","slategray"))+
scale_y_continuous(limits=c(0,12000), breaks=seq(0,12000,1000))+
theme_bw()+
theme(legend.position = "none",
axis.text.x = element_blank(),
axis.text.y = element_text(size=10),
axis.title.x =  element_blank(),
axis.title.y =  element_text(size=10),
axis.ticks.x=element_blank(),
axis.text = element_text(size=10),
axis.title = element_text(size=12))
Fig6C
ggdraw() +
draw_plot(Fig6C, x = 0.5, y = 0, width = 0.5, height = 1) +
draw_plot(Fig6B, x = 0, y = 0, width = 0.5, height = 0.5) +
draw_plot(Fig6A, x = 0, y = 0.5, width = 0.5, height = 0.5) +
draw_plot_label(label = c("C", "B", "A"),
size = 15,
x = c(0.5,0,0),
y = c(1,0.5,1))
data2$RTS_Ht = data2$line_raw_slope_N.m/data2$Plant.Ht
data2$RTS_SD = data2$line_raw_slope_N.m/data2$StalkDiamAvg
FigS5A=ggplot(data=data2,aes(x=Density, y=RTS_Ht, fill=Genotype.x))+
geom_boxplot(size = 0.25) +
xlab("Density (plants/row)") +
ylab("Root System Stiffness/Stalk Height")+
labs(fill = "Density (plants/row)")+
scale_y_continuous(limits=c(0,40), breaks=seq(0,40,5))+
scale_fill_manual(values=c("pink4","slategray"))+
theme_bw()+
theme(legend.position = "none",
axis.text.x = element_blank(),
axis.text.y = element_blank(),
axis.title.x =  element_blank(),
axis.title.y =  element_text(size=10),
axis.ticks.x=element_blank(),
axis.text = element_text(size=10),
axis.title = element_text(size=12))
FigS5A
FigS5B=ggplot(data=data2,aes(x=Density, y=RTS_SD, fill=Genotype.x))+
geom_boxplot(size = 0.25) +
xlab("Density (plants/row)") +
ylab("Root System Stiffness/Stalk diameter")+
labs(fill = "Density (plants/row)")+
scale_y_continuous(limits=c(0,250), breaks=seq(0,250,25))+
scale_fill_manual(values=c("pink4","slategray"))+
theme_bw()+
theme(legend.position = "none",
axis.text.x = element_blank(),
axis.text.y = element_blank(),
axis.title.x =  element_blank(),
axis.title.y =  element_text(size=10),
axis.ticks.x=element_blank(),
axis.text = element_text(size=10),
axis.title = element_text(size=12))
FigS5B
ggdraw() +
draw_plot(FigS5B, x = 0.5, y = 0, width = 0.5, height = 1) +
draw_plot(FigS5A, x = 0, y = 0, width = 0.5, height = 1) +
draw_plot_label(label = c("A", "B"),
size = 15,
x = c(0,0.5),
y = c(1,1))
#Stats - Does Genotype or Density impact RTS/Height
attach(data2)
lm_x <- lm(RTS_Ht ~ Genotype.x*Density)
anova(lm_x)
lm_x_aov=aov(lm_x)
HSD.test(lm_x_aov, trt = c("Density","Genotype"), console = TRUE)
HSD.test(lm_x_aov, trt = c("Density"), console = TRUE)
par(mfrow=c(2,2))
plot(lm_x)
par(mfrow=c(2,1))
plot(data2$RTS_Ht)
hist(data2$RTS_Ht)
resid = residuals(object = lm_x_aov)
shapiro.test(x=resid)
leveneTest(RTS_Ht ~ Genotype.x*Density)
detach(data2)
#Stats - Does Genotype or Density impact RTS_SD
attach(data2)
lm_x <- lm(RTS_SD ~ Genotype.x*Density)
anova(lm_x)
lm_x_aov=aov(lm_x)
HSD.test(lm_x_aov, trt = c("Density","Genotype"), console = TRUE)
HSD.test(lm_x_aov, trt = c("Density"), console = TRUE)
par(mfrow=c(2,2))
plot(lm_x)
par(mfrow=c(2,1))
plot(data2$RTS_SD)
hist(data2$RTS_SD)
resid = residuals(object = lm_x_aov)
shapiro.test(x=resid)
leveneTest(RTS_SD ~ Genotype.x*Density)
detach(data2)
#Supplemental Figure: Root lodging susceptibility is variable among maize hybrids and random in the field.####
cat("\014")
rm(list=ls())
ls()
setwd(dir = "/Users/ashley/Desktop/Hostetler_Reneau_et_al_2023/R Input Files/")
data = read.csv("2020_LodgingData.csv", header = TRUE, na.strings = "NA")
#Count total number of Y, N, and calculate percent lodged
df = data %>%
count(Genotype, Plot, Lodged.)
df <- spread(df, Lodged., n)
df$N[is.na(df$N)] = 0
df$Y[is.na(df$Y)] = 0
df$Total = df$N + df$Y
df$percent_lodged = round((((df$Y)/(df$Total)) * 100), digits = 2)
head(df)
df = df %>%
group_by(Genotype) %>%
mutate(id = row_number())
names(df)[7] = "Rep"
#Figures
df$Rep = as.character(df$Rep)
df$Genotype = factor(df$Genotype,levels = c("PHB47 x LH198","PHB47 x PHP02","LH82 x DK3IIH6","PHK56 x PHK76","PHK76 x PHP02",
"LH145 x DK3IIH6","DK3IIH6 x LH198","LH198 x PHN46","LH82 x PHK76","LH82 x PHP02","LH82 x LH145"))
data1 = read.csv("2020_LodgingData_PlotLocation.csv", header = TRUE, na.strings = "NA")
df = merge(df, data1, by = "Plot")
FigS1A=ggplot(df, aes(Row, Column, fill= percent_lodged)) +
geom_tile()+
geom_text(label=df$Genotype)+
scale_fill_gradient(low="white", high="indianred4")+
xlab("Row") +
ylab("Column")+
labs(fill = "%Lodged")+
theme(axis.text.x = element_text(size=12),
axis.text.y = element_text(size=12),
plot.title=element_text(size=12, vjust=3),
axis.text=element_text(size=12),
axis.title = element_text(size=12),
axis.title.y= element_text(vjust=2.5),
axis.title.x= element_text(vjust=-1.4),
axis.ticks.length = unit(.2,"cm"),
strip.background = element_rect(fill="grey"),
strip.text.x = element_text(size = 12, angle = 90, colour = "black"),
strip.text.y = element_text(size = 12, colour = "black"))
FigS1A
FigS1B=ggplot(data=df,aes(x=Genotype, y=percent_lodged, fill=Rep))+
geom_bar(position="dodge", stat="identity")+
xlab("Genotype") +
ylab("%Lodged")+
labs(fill = "Plot Replicate")+
scale_fill_manual(values=c("mistyrose3","slategrey"))+
theme(axis.text.x = element_text(size=12,  angle = 90),
axis.text.y = element_text(size=12),
plot.title=element_text(size=12, vjust=3),
axis.text=element_text(size=12),
axis.title = element_text(size=12),
axis.title.y= element_text(vjust=2.5),
axis.title.x= element_text(vjust=-1.4),
axis.ticks.length = unit(.2,"cm"),
strip.background = element_rect(fill="grey"),
strip.text.x = element_text(size = 12, angle = 90, colour = "black"),
strip.text.y = element_text(size = 12, colour = "black"))
FigS1B
ggdraw() +
draw_plot(FigS1A, x = 0, y = 0, width = 1, height = 0.5) +
draw_plot(FigS1B, x = 0, y = 0.5, width = 1, height = 0.5) +
draw_plot_label(label = c("B", "A"),
size = 15,
x = c(0, 0),
y = c(0.5, 1))
